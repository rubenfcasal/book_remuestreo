<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.3 Cálculo de la distribución Bootstrap: exacta y aproximada | Técnicas de Remuestreo</title>
  <meta name="description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="1.3 Cálculo de la distribución Bootstrap: exacta y aproximada | Técnicas de Remuestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rubenfcasal/book_remuestreo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.3 Cálculo de la distribución Bootstrap: exacta y aproximada | Técnicas de Remuestreo" />
  
  <meta name="twitter:description" content="Apuntes de la asignatura de Técnicas de Remuestreo del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Ricardo Cao Abad (rcao@udc.es) y Rubén Fernández Casal (rfcasal@udc.es)" />


<meta name="date" content="2022-09-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-unif.html"/>
<link rel="next" href="intro-paquetes.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Técnicas de Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Motivación del principio Bootstrap</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introducción.html"><a href="introducción.html#breve-nota-histórica"><i class="fa fa-check"></i><b>1.1.1</b> Breve nota histórica</a></li>
<li class="chapter" data-level="1.1.2" data-path="introducción.html"><a href="introducción.html#paradigma-inferencial-y-análogo-bootstrap"><i class="fa fa-check"></i><b>1.1.2</b> Paradigma inferencial y análogo bootstrap</a></li>
<li class="chapter" data-level="1.1.3" data-path="introducción.html"><a href="introducción.html#intro-implementacion"><i class="fa fa-check"></i><b>1.1.3</b> Implementación en la práctica</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro-unif.html"><a href="intro-unif.html"><i class="fa fa-check"></i><b>1.2</b> El Bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro-unif.html"><a href="intro-unif.html#ejemplos"><i class="fa fa-check"></i><b>1.2.1</b> Ejemplos</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><i class="fa fa-check"></i><b>1.3</b> Cálculo de la distribución Bootstrap: exacta y aproximada</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#distribución-bootstrap-exacta"><i class="fa fa-check"></i><b>1.3.1</b> Distribución bootstrap exacta</a></li>
<li class="chapter" data-level="1.3.2" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#vectores-de-remuestreo"><i class="fa fa-check"></i><b>1.3.2</b> Vectores de remuestreo</a></li>
<li class="chapter" data-level="1.3.3" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#inferencia-sobre-la-mediana"><i class="fa fa-check"></i><b>1.3.3</b> Inferencia sobre la mediana</a></li>
<li class="chapter" data-level="1.3.4" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#distribución-bootstrap-aproximada-por-monte-carlo"><i class="fa fa-check"></i><b>1.3.4</b> Distribución Bootstrap aproximada por Monte Carlo</a></li>
<li class="chapter" data-level="1.3.5" data-path="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#elección-del-número-de-réplicas-monte-carlo"><i class="fa fa-check"></i><b>1.3.5</b> Elección del número de réplicas Monte Carlo</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro-paquetes.html"><a href="intro-paquetes.html"><i class="fa fa-check"></i><b>1.4</b> Herramientas disponibles en R sobre bootstrap</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro-paquetes.html"><a href="intro-paquetes.html#intro-pkgboot"><i class="fa fa-check"></i><b>1.4.1</b> El paquete <code>boot</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="intro-paquetes.html"><a href="intro-paquetes.html#boot-unif-multi"><i class="fa fa-check"></i><b>1.4.2</b> Ejemplo: Bootstrap uniforme multidimensional</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prec-sesgo.html"><a href="prec-sesgo.html"><i class="fa fa-check"></i><b>2</b> Estimación de la precisión y el sesgo de un estimador</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prec-sesgo-boot.html"><a href="prec-sesgo-boot.html"><i class="fa fa-check"></i><b>2.1</b> Estimación bootstrap de la precisión y el sesgo de un estimador</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="prec-sesgo-boot.html"><a href="prec-sesgo-boot.html#ejemplo-la-media-muestral"><i class="fa fa-check"></i><b>2.1.1</b> Ejemplo: la media muestral</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="jackknife.html"><a href="jackknife.html"><i class="fa fa-check"></i><b>2.2</b> Motivación del método Jackknife</a></li>
<li class="chapter" data-level="2.3" data-path="estimación-jackknife-de-la-precisión-y-el-sesgo-de-un-estimador.html"><a href="estimación-jackknife-de-la-precisión-y-el-sesgo-de-un-estimador.html"><i class="fa fa-check"></i><b>2.3</b> Estimación Jackknife de la precisión y el sesgo de un estimador</a></li>
<li class="chapter" data-level="2.4" data-path="relación-bootstrapjackknife-en-dicha-estimación.html"><a href="relación-bootstrapjackknife-en-dicha-estimación.html"><i class="fa fa-check"></i><b>2.4</b> Relación Bootstrap/Jackknife en dicha estimación</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modunif.html"><a href="modunif.html"><i class="fa fa-check"></i><b>3</b> Modificaciones del Bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modunif-boot-par.html"><a href="modunif-boot-par.html"><i class="fa fa-check"></i><b>3.1</b> Bootstrap paramétrico</a></li>
<li class="chapter" data-level="3.2" data-path="bootstrap-simetrizado.html"><a href="bootstrap-simetrizado.html"><i class="fa fa-check"></i><b>3.2</b> Bootstrap simetrizado</a></li>
<li class="chapter" data-level="3.3" data-path="modunif-boot-suav.html"><a href="modunif-boot-suav.html"><i class="fa fa-check"></i><b>3.3</b> Bootstrap suavizado</a></li>
<li class="chapter" data-level="3.4" data-path="bootstrap-ponderado-y-bootstrap-sesgado.html"><a href="bootstrap-ponderado-y-bootstrap-sesgado.html"><i class="fa fa-check"></i><b>3.4</b> Bootstrap ponderado y bootstrap sesgado</a></li>
<li class="chapter" data-level="3.5" data-path="deficien-unif.html"><a href="deficien-unif.html"><i class="fa fa-check"></i><b>3.5</b> Deficiencias del bootstrap uniforme</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="deficien-unif.html"><a href="deficien-unif.html#ejemplo-método-alternativo"><i class="fa fa-check"></i><b>3.5.1</b> Ejemplo (método alternativo)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="validez-de-la-aproximación-bootstrap.html"><a href="validez-de-la-aproximación-bootstrap.html"><i class="fa fa-check"></i><b>3.6</b> Validez de la aproximación Bootstrap</a></li>
<li class="chapter" data-level="3.7" data-path="boot-reg.html"><a href="boot-reg.html"><i class="fa fa-check"></i><b>3.7</b> Bootstrap semiparamétrico y bootstrap residual</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="boot-reg.html"><a href="boot-reg.html#boot-unif-reg"><i class="fa fa-check"></i><b>3.7.1</b> Remuestreo de las observaciones</a></li>
<li class="chapter" data-level="3.7.2" data-path="boot-reg.html"><a href="boot-reg.html#boot-residual"><i class="fa fa-check"></i><b>3.7.2</b> Bootstrap residual</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="icboot.html"><a href="icboot.html"><i class="fa fa-check"></i><b>4</b> Intervalos de confianza bootstrap</a>
<ul>
<li class="chapter" data-level="4.1" data-path="icboot-norm.html"><a href="icboot-norm.html"><i class="fa fa-check"></i><b>4.1</b> Intervalos basados en la distribución normal asintótica</a></li>
<li class="chapter" data-level="4.2" data-path="icboot-basic.html"><a href="icboot-basic.html"><i class="fa fa-check"></i><b>4.2</b> Método percentil (básico)</a></li>
<li class="chapter" data-level="4.3" data-path="icboot-perc-t.html"><a href="icboot-perc-t.html"><i class="fa fa-check"></i><b>4.3</b> Método percentil-<em>t</em></a></li>
<li class="chapter" data-level="4.4" data-path="icboot-perc-t-sim.html"><a href="icboot-perc-t-sim.html"><i class="fa fa-check"></i><b>4.4</b> Método percentil-<em>t</em> simetrizado</a></li>
<li class="chapter" data-level="4.5" data-path="cap-err-cober.html"><a href="cap-err-cober.html"><i class="fa fa-check"></i><b>4.5</b> Tabla resumen de los errores de cobertura</a></li>
<li class="chapter" data-level="4.6" data-path="icboot-ejem.html"><a href="icboot-ejem.html"><i class="fa fa-check"></i><b>4.6</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="icboot-ejem.html"><a href="icboot-ejem.html#media-dt-desconocida-persim"><i class="fa fa-check"></i><b>4.6.1</b> IC bootstrap para la media mediante el método percentil-<em>t</em> simetrizado</a></li>
<li class="chapter" data-level="4.6.2" data-path="icboot-ejem.html"><a href="icboot-ejem.html#estudio-sim-exp"><i class="fa fa-check"></i><b>4.6.2</b> Estudio de simulación</a></li>
<li class="chapter" data-level="4.6.3" data-path="icboot-ejem.html"><a href="icboot-ejem.html#icboot-trans"><i class="fa fa-check"></i><b>4.6.3</b> IC bootstrap para el coeficiente de correlación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="contrastes.html"><a href="contrastes.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones del Bootstrap en contrastes de hipótesis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="aproximación-del-p-valor-mediante-remuestreo.html"><a href="aproximación-del-p-valor-mediante-remuestreo.html"><i class="fa fa-check"></i><b>5.1</b> Aproximación del p-valor mediante remuestreo</a></li>
<li class="chapter" data-level="5.2" data-path="contrastes-parametricos.html"><a href="contrastes-parametricos.html"><i class="fa fa-check"></i><b>5.2</b> Contrastes bootstrap paramétricos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="contrastes-parametricos.html"><a href="contrastes-parametricos.html#ejemplo-contraste-de-kolmogorov-smirnov"><i class="fa fa-check"></i><b>5.2.1</b> Ejemplo: contraste de Kolmogorov-Smirnov</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="contrastes-de-permutaciones.html"><a href="contrastes-de-permutaciones.html"><i class="fa fa-check"></i><b>5.3</b> Contrastes de permutaciones</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="contrastes-de-permutaciones.html"><a href="contrastes-de-permutaciones.html#ejemplo-inferencia-sobre-el-coeficiente-de-correlación-lineal"><i class="fa fa-check"></i><b>5.3.1</b> Ejemplo: Inferencia sobre el coeficiente de correlación lineal</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="contrastes-semiparametricos.html"><a href="contrastes-semiparametricos.html"><i class="fa fa-check"></i><b>5.4</b> Contrastes bootstrap semiparamétricos</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="contrastes-semiparametricos.html"><a href="contrastes-semiparametricos.html#ejemplo-inferencia-sobre-modelos-de-regresión"><i class="fa fa-check"></i><b>5.4.1</b> Ejemplo: Inferencia sobre modelos de regresión</a></li>
<li class="chapter" data-level="5.4.2" data-path="contrastes-semiparametricos.html"><a href="contrastes-semiparametricos.html#ejercicio"><i class="fa fa-check"></i><b>5.4.2</b> Ejercicio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="npden.html"><a href="npden.html"><i class="fa fa-check"></i><b>6</b> Bootstrap y estimación no paramétrica de la densidad</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimación-no-paramétrica-de-la-función-de-densidad.html"><a href="estimación-no-paramétrica-de-la-función-de-densidad.html"><i class="fa fa-check"></i><b>6.1</b> Estimación no paramétrica de la función de densidad</a></li>
<li class="chapter" data-level="6.2" data-path="sesgo-varianza-y-error-cuadrático-medio.html"><a href="sesgo-varianza-y-error-cuadrático-medio.html"><i class="fa fa-check"></i><b>6.2</b> Sesgo, varianza y error cuadrático medio</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sesgo-varianza-y-error-cuadrático-medio.html"><a href="sesgo-varianza-y-error-cuadrático-medio.html#sesgo"><i class="fa fa-check"></i><b>6.2.1</b> Sesgo</a></li>
<li class="chapter" data-level="6.2.2" data-path="sesgo-varianza-y-error-cuadrático-medio.html"><a href="sesgo-varianza-y-error-cuadrático-medio.html#varianza"><i class="fa fa-check"></i><b>6.2.2</b> Varianza</a></li>
<li class="chapter" data-level="6.2.3" data-path="sesgo-varianza-y-error-cuadrático-medio.html"><a href="sesgo-varianza-y-error-cuadrático-medio.html#error-cuadrático-medio"><i class="fa fa-check"></i><b>6.2.3</b> Error cuadrático medio</a></li>
<li class="chapter" data-level="6.2.4" data-path="sesgo-varianza-y-error-cuadrático-medio.html"><a href="sesgo-varianza-y-error-cuadrático-medio.html#error-cuadrático-medio-integrado-mise"><i class="fa fa-check"></i><b>6.2.4</b> Error cuadrático medio integrado (MISE)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="aproximacion-bootstrap.html"><a href="aproximacion-bootstrap.html"><i class="fa fa-check"></i><b>6.3</b> Aproximación Bootstrap de la distribución del estimador de Parzen-Rosenblatt</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aproximacion-bootstrap.html"><a href="aproximacion-bootstrap.html#distribución-asintótica-del-estimador-de-parzen-rosenblatt"><i class="fa fa-check"></i><b>6.3.1</b> Distribución asintótica del estimador de Parzen-Rosenblatt</a></li>
<li class="chapter" data-level="6.3.2" data-path="aproximacion-bootstrap.html"><a href="aproximacion-bootstrap.html#aproximación-plug-in"><i class="fa fa-check"></i><b>6.3.2</b> Aproximación plug-in</a></li>
<li class="chapter" data-level="6.3.3" data-path="aproximacion-bootstrap.html"><a href="aproximacion-bootstrap.html#aproximación-bootstrap"><i class="fa fa-check"></i><b>6.3.3</b> Aproximación bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><i class="fa fa-check"></i><b>6.4</b> El Bootstrap en la selección del parámetro de suavizado.</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#expresión-asintótica-de-la-ventana-óptima"><i class="fa fa-check"></i><b>6.4.1</b> Expresión asintótica de la ventana óptima</a></li>
<li class="chapter" data-level="6.4.2" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#análogo-bootstrap-del-mise"><i class="fa fa-check"></i><b>6.4.2</b> Análogo bootstrap del <span class="math inline">\(MISE\)</span></a></li>
<li class="chapter" data-level="6.4.3" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#expresión-cerrada-para-miseast"><i class="fa fa-check"></i><b>6.4.3</b> Expresión cerrada para <span class="math inline">\(MISE^{\ast}\)</span></a></li>
<li class="chapter" data-level="6.4.4" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#elección-de-la-ventana-piloto"><i class="fa fa-check"></i><b>6.4.4</b> Elección de la ventana piloto</a></li>
<li class="chapter" data-level="6.4.5" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#resultados-teóricos"><i class="fa fa-check"></i><b>6.4.5</b> Resultados teóricos</a></li>
<li class="chapter" data-level="6.4.6" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#caso-particular-de-núcleo-gaussiano"><i class="fa fa-check"></i><b>6.4.6</b> Caso particular de núcleo gaussiano</a></li>
<li class="chapter" data-level="6.4.7" data-path="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html"><a href="el-bootstrap-en-la-selección-del-parámetro-de-suavizado..html#comparación-con-otros-selectores"><i class="fa fa-check"></i><b>6.4.7</b> Comparación con otros selectores</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="npden-r.html"><a href="npden-r.html"><i class="fa fa-check"></i><b>6.5</b> Estimación no paramétrica de la densidad en R</a></li>
<li class="chapter" data-level="6.6" data-path="ejemplos-1.html"><a href="ejemplos-1.html"><i class="fa fa-check"></i><b>6.6</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ejemplos-1.html"><a href="ejemplos-1.html#bootstrap-y-estimación-del-sesgo"><i class="fa fa-check"></i><b>6.6.1</b> Bootstrap y estimación del sesgo</a></li>
<li class="chapter" data-level="6.6.2" data-path="ejemplos-1.html"><a href="ejemplos-1.html#npden-r-ic"><i class="fa fa-check"></i><b>6.6.2</b> Estimación por intervalos de confianza</a></li>
<li class="chapter" data-level="6.6.3" data-path="ejemplos-1.html"><a href="ejemplos-1.html#npden-r-boot"><i class="fa fa-check"></i><b>6.6.3</b> Implementación con el paquete <code>boot</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="npreg.html"><a href="npreg.html"><i class="fa fa-check"></i><b>7</b> Bootstrap y regresión no paramétrica</a>
<ul>
<li class="chapter" data-level="7.1" data-path="nadaraya-watson.html"><a href="nadaraya-watson.html"><i class="fa fa-check"></i><b>7.1</b> Estimador de Nadaraya-Watson</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="nadaraya-watson.html"><a href="nadaraya-watson.html#distribución-asintótica-del-estimador-de-nadaraya-watson"><i class="fa fa-check"></i><b>7.1.1</b> Distribución asintótica del estimador de Nadaraya-Watson</a></li>
<li class="chapter" data-level="7.1.2" data-path="nadaraya-watson.html"><a href="nadaraya-watson.html#órdenes-de-convergencia-de-la-distribución-del-estimador-de-nadaraya-watson-a-su-distribución-asintótica"><i class="fa fa-check"></i><b>7.1.2</b> Órdenes de convergencia de la distribución del estimador de Nadaraya-Watson a su distribución asintótica</a></li>
<li class="chapter" data-level="7.1.3" data-path="nadaraya-watson.html"><a href="nadaraya-watson.html#aproximación-plug-in-1"><i class="fa fa-check"></i><b>7.1.3</b> Aproximación plug-in</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="métodos-de-remuestreo-en-regresión-no-paramétrica.html"><a href="métodos-de-remuestreo-en-regresión-no-paramétrica.html"><i class="fa fa-check"></i><b>7.2</b> Métodos de remuestreo en regresión no paramétrica</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="métodos-de-remuestreo-en-regresión-no-paramétrica.html"><a href="métodos-de-remuestreo-en-regresión-no-paramétrica.html#wild-bootstrap"><i class="fa fa-check"></i><b>7.2.1</b> Wild bootstrap</a></li>
<li class="chapter" data-level="7.2.2" data-path="métodos-de-remuestreo-en-regresión-no-paramétrica.html"><a href="métodos-de-remuestreo-en-regresión-no-paramétrica.html#bootstrap-suavizado-en-la-variable-explicativa"><i class="fa fa-check"></i><b>7.2.2</b> Bootstrap suavizado en la variable explicativa</a></li>
<li class="chapter" data-level="7.2.3" data-path="métodos-de-remuestreo-en-regresión-no-paramétrica.html"><a href="métodos-de-remuestreo-en-regresión-no-paramétrica.html#resumen-comparativo"><i class="fa fa-check"></i><b>7.2.3</b> Resumen comparativo</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="locpol-r.html"><a href="locpol-r.html"><i class="fa fa-check"></i><b>7.3</b> Regresión polinómica local en R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="locpol-r.html"><a href="locpol-r.html#estimación-de-la-varianza"><i class="fa fa-check"></i><b>7.3.1</b> Estimación de la varianza</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ejemplos-2.html"><a href="ejemplos-2.html"><i class="fa fa-check"></i><b>7.4</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ejemplos-2.html"><a href="ejemplos-2.html#bootstrap-residual"><i class="fa fa-check"></i><b>7.4.1</b> Bootstrap residual</a></li>
<li class="chapter" data-level="7.4.2" data-path="ejemplos-2.html"><a href="ejemplos-2.html#intervalos-de-confianza-y-predicción"><i class="fa fa-check"></i><b>7.4.2</b> Intervalos de confianza y predicción</a></li>
<li class="chapter" data-level="7.4.3" data-path="ejemplos-2.html"><a href="ejemplos-2.html#r-wild-bootstrap"><i class="fa fa-check"></i><b>7.4.3</b> Wild bootstrap</a></li>
<li class="chapter" data-level="7.4.4" data-path="ejemplos-2.html"><a href="ejemplos-2.html#ejercicio-1"><i class="fa fa-check"></i><b>7.4.4</b> Ejercicio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bootcen.html"><a href="bootcen.html"><i class="fa fa-check"></i><b>8</b> El Bootstrap con datos censurados</a>
<ul>
<li class="chapter" data-level="8.1" data-path="introducción-a-los-datos-censurados.html"><a href="introducción-a-los-datos-censurados.html"><i class="fa fa-check"></i><b>8.1</b> Introducción a los datos censurados</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="introducción-a-los-datos-censurados.html"><a href="introducción-a-los-datos-censurados.html#estimador-de-kaplan-meier"><i class="fa fa-check"></i><b>8.1.1</b> Estimador de Kaplan-Meier</a></li>
<li class="chapter" data-level="8.1.2" data-path="introducción-a-los-datos-censurados.html"><a href="introducción-a-los-datos-censurados.html#distribución-asintótica-del-estimador-de-kaplan-meier"><i class="fa fa-check"></i><b>8.1.2</b> Distribución asintótica del estimador de Kaplan-Meier</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html"><i class="fa fa-check"></i><b>8.2</b> Remuestreos Bootstrap en presencia de censura</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html#el-bootstrap-simple"><i class="fa fa-check"></i><b>8.2.1</b> El bootstrap simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="remuestreos-bootstrap-en-presencia-de-censura.html"><a href="remuestreos-bootstrap-en-presencia-de-censura.html#bootcen-obvio"><i class="fa fa-check"></i><b>8.2.2</b> El bootstrap obvio</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html"><i class="fa fa-check"></i><b>8.3</b> Relaciones entre los métodos de remuestreo bajo censura</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html#equivalencia-entre-el-bootstrap-simple-y-el-obvio"><i class="fa fa-check"></i><b>8.3.1</b> Equivalencia entre el bootstrap simple y el obvio</a></li>
<li class="chapter" data-level="8.3.2" data-path="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html#bootcen-reid"><i class="fa fa-check"></i><b>8.3.2</b> El bootstrap de Reid</a></li>
<li class="chapter" data-level="8.3.3" data-path="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html"><a href="relaciones-entre-los-métodos-de-remuestreo-bajo-censura.html#validez-de-los-planes-de-remuestreo"><i class="fa fa-check"></i><b>8.3.3</b> Validez de los planes de remuestreo</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="implementación-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementación-en-r-con-los-paquetes-boot-y-survival.html"><i class="fa fa-check"></i><b>8.4</b> Implementación en <code>R</code> (con los paquetes <code>boot</code> y <code>survival</code>)</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="implementación-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementación-en-r-con-los-paquetes-boot-y-survival.html#bootstrap-simple"><i class="fa fa-check"></i><b>8.4.1</b> Bootstrap simple</a></li>
<li class="chapter" data-level="8.4.2" data-path="implementación-en-r-con-los-paquetes-boot-y-survival.html"><a href="implementación-en-r-con-los-paquetes-boot-y-survival.html#otros-métodos-de-remuestreo"><i class="fa fa-check"></i><b>8.4.2</b> Otros métodos de remuestreo</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ejercicios.html"><a href="ejercicios.html"><i class="fa fa-check"></i><b>8.5</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bootdep.html"><a href="bootdep.html"><i class="fa fa-check"></i><b>9</b> El Bootstrap con datos dependientes</a>
<ul>
<li class="chapter" data-level="9.1" data-path="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><i class="fa fa-check"></i><b>9.1</b> Introducción a las condiciones de dependencia y modelos habituales de datos dependientes</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html#situaciones-de-dependencia-general"><i class="fa fa-check"></i><b>9.1.1</b> Situaciones de dependencia general</a></li>
<li class="chapter" data-level="9.1.2" data-path="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html"><a href="introducción-a-las-condiciones-de-dependencia-y-modelos-habituales-de-datos-dependientes.html#modelos-paramétricos-de-dependencia"><i class="fa fa-check"></i><b>9.1.2</b> Modelos paramétricos de dependencia</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><i class="fa fa-check"></i><b>9.2</b> El bootstrap en la estimación con datos dependientes</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#modelos-paramétricos-de-dependencia-1"><i class="fa fa-check"></i><b>9.2.1</b> Modelos paramétricos de dependencia</a></li>
<li class="chapter" data-level="9.2.2" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#situaciones-de-dependencia-general-1"><i class="fa fa-check"></i><b>9.2.2</b> Situaciones de dependencia general</a></li>
<li class="chapter" data-level="9.2.3" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#el-bootstrap-por-bloques"><i class="fa fa-check"></i><b>9.2.3</b> El bootstrap por bloques</a></li>
<li class="chapter" data-level="9.2.4" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#elección-de-b"><i class="fa fa-check"></i><b>9.2.4</b> Elección de <span class="math inline">\(b\)</span></a></li>
<li class="chapter" data-level="9.2.5" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#el-bootstrap-estacionario"><i class="fa fa-check"></i><b>9.2.5</b> El bootstrap estacionario</a></li>
<li class="chapter" data-level="9.2.6" data-path="el-bootstrap-en-la-estimación-con-datos-dependientes.html"><a href="el-bootstrap-en-la-estimación-con-datos-dependientes.html#el-método-del-submuestreo"><i class="fa fa-check"></i><b>9.2.6</b> El método del submuestreo</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="el-bootstrap-para-la-predicción-con-datos-dependientes.html"><a href="el-bootstrap-para-la-predicción-con-datos-dependientes.html"><i class="fa fa-check"></i><b>9.3</b> El bootstrap para la predicción con datos dependientes</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="el-bootstrap-para-la-predicción-con-datos-dependientes.html"><a href="el-bootstrap-para-la-predicción-con-datos-dependientes.html#modelos-de-dependencia-paramétrica"><i class="fa fa-check"></i><b>9.3.1</b> Modelos de dependencia paramétrica</a></li>
<li class="chapter" data-level="9.3.2" data-path="el-bootstrap-para-la-predicción-con-datos-dependientes.html"><a href="el-bootstrap-para-la-predicción-con-datos-dependientes.html#situaciones-de-dependencia-general-2"><i class="fa fa-check"></i><b>9.3.2</b> Situaciones de dependencia general</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="implementación-en-r.html"><a href="implementación-en-r.html"><i class="fa fa-check"></i><b>9.4</b> Implementación en <code>R</code></a></li>
<li class="chapter" data-level="9.5" data-path="implementación-en-r-con-el-paquete-boot.html"><a href="implementación-en-r-con-el-paquete-boot.html"><i class="fa fa-check"></i><b>9.5</b> Implementación en <code>R</code> con el paquete <code>boot</code></a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="implementación-en-r-con-el-paquete-boot.html"><a href="implementación-en-r-con-el-paquete-boot.html#rnews-1"><i class="fa fa-check"></i><b>9.5.1</b> Rnews 1</a></li>
<li class="chapter" data-level="9.5.2" data-path="implementación-en-r-con-el-paquete-boot.html"><a href="implementación-en-r-con-el-paquete-boot.html#rnews-2"><i class="fa fa-check"></i><b>9.5.2</b> Rnews 2</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="ejercicios-1.html"><a href="ejercicios-1.html"><i class="fa fa-check"></i><b>9.6</b> Ejercicios</a></li>
<li class="chapter" data-level="9.7" data-path="implementación-en-r-con-el-paquete-forecast.html"><a href="implementación-en-r-con-el-paquete-forecast.html"><i class="fa fa-check"></i><b>9.7</b> Implementación en <code>R</code> con el paquete <code>forecast</code></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="implementación-en-r-con-el-paquete-forecast.html"><a href="implementación-en-r-con-el-paquete-forecast.html#bootstrap-condicional-a-partir-de-un-modelo-ajustado"><i class="fa fa-check"></i><b>9.7.1</b> Bootstrap condicional (a partir de un modelo ajustado)</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>9.8</b> Spatial data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a>
<ul>
<li class="chapter" data-level="A.1" data-path="forecast-links.html"><a href="forecast-links.html"><i class="fa fa-check"></i><b>A.1</b> Forecasting: Principles and Practice</a></li>
<li class="chapter" data-level="A.2" data-path="spatial-links.html"><a href="spatial-links.html"><i class="fa fa-check"></i><b>A.2</b> Spatial data</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="intro-hpc.html"><a href="intro-hpc.html"><i class="fa fa-check"></i><b>B</b> Introducción al procesamiento en paralelo en R</a>
<ul>
<li class="chapter" data-level="B.1" data-path="introducción-1.html"><a href="introducción-1.html"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="paquetes-en-r.html"><a href="paquetes-en-r.html"><i class="fa fa-check"></i><b>B.2</b> Paquetes en R</a></li>
<li class="chapter" data-level="B.3" data-path="ejemplos-3.html"><a href="ejemplos-3.html"><i class="fa fa-check"></i><b>B.3</b> Ejemplos</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="ejemplos-3.html"><a href="ejemplos-3.html#procesamiento-en-paralelo-con-la-función-boot"><i class="fa fa-check"></i><b>B.3.1</b> Procesamiento en paralelo con la función <code>boot()</code></a></li>
<li class="chapter" data-level="B.3.2" data-path="ejemplos-3.html"><a href="ejemplos-3.html#estudio-sim-boot"><i class="fa fa-check"></i><b>B.3.2</b> Estudio de simulación</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Técnicas de Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Cálculo de la distribución Bootstrap: exacta y aproximada</h2>
<div id="distribución-bootstrap-exacta" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Distribución bootstrap exacta</h3>
<p>En principio siempre es posible calcular la distribución en el
remuestreo del estadístico bootstrap de forma exacta. Al menos para el
bootstrap uniforme, que es el más habitual. El motivo es que la
distribución de probabilidad de la que se remuestrea en el universo
bootstrap es discreta y con un número finito de valores: <span class="math inline">\(X_1,\ldots ,X_n\)</span>. Así pues, cada observación bootstrap, <span class="math inline">\(X_i^{\ast}\)</span>, ha de
tomar necesariamente alguno de esos <span class="math inline">\(n\)</span> valores y, por tanto, el número
de posibles remuestras, <span class="math inline">\(\mathbf{X}^{\ast}=\left( X_1^{\ast },\ldots ,X_n^{\ast} \right)\)</span>, obtenibles mediante el bootstrap
uniforme es finito, concretamente <span class="math inline">\(n^{n}\)</span>. Aún siendo finito, este
número es gigantescamente grande incluso para tamaños muestrales
pequeños (salvo casos extremos del tipo <span class="math inline">\(n=2,\ldots ,9\)</span>). Por ejemplo,
para <span class="math inline">\(n=10\)</span>, tenemos <span class="math inline">\(10^{10}\)</span> (diez mil millones de) posibles
remuestras bootstrap y para <span class="math inline">\(n=20\)</span>, tendríamos
<span class="math inline">\(20^{20}\simeq 10.4857\cdot 10^{25}\)</span> (algo más de cien
cuatrillones). Incluso para estos tamaños muestrales el problema de
cálculo de la distribución bootstrap exacta de
<span class="math inline">\(\mathbf{X}^{\ast}\)</span> es inabordable.</p>
</div>
<div id="vectores-de-remuestreo" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Vectores de remuestreo</h3>
<p>Una forma alternativa de representar las posibles remuestras bootstrap
es mediante los llamados vectores de remuestreo. Son utilizables en el
caso de que el estadístico de interés sea funcional, es decir, cuando
<span class="math inline">\(R\)</span> depende de la muestra sólo a través de la distribución empírica o,
lo que es lo mismo, el valor de <span class="math inline">\(R\)</span> no cambia cuando realizamos una
permutación arbitraria sobre los elementos de la muestra (los cambiamos
de orden). Consideremos la remuestra bootstrap
<span class="math inline">\(\mathbf{X}^{\ast} =\left( X_1^{\ast},\ldots ,X_n^{\ast} \right)\)</span> y denotemos por
<span class="math display">\[N_j=\#\left\{ i\in \left\{ 1,\ldots ,n\right\} : 
X_i^{\ast}=X_j\right\}.\]</span>
Obviamente, si el orden en el que se han obtenido los
elementos de la muestra no es importante, entonces el vector
<span class="math inline">\(\mathbf{N}=\left( N_1,\ldots ,N_n \right)\)</span> contiene la misma
información que la remuestra bootstrap <span class="math inline">\(\mathbf{X}^{\ast}\)</span>.
Esencialmente lo que hace el vector <span class="math inline">\(\mathbf{N}\)</span> es contabilizar
cuantas veces se repite cada elemento de la muestra original en la
remuestra bootstrap. Con esta notación, el vector de remuestreo
bootstrap,
<span class="math inline">\(\mathbf{P}^{\ast}=\left( P_1^{\ast},\ldots ,P_n^{\ast} \right)\)</span>,
se define como <span class="math inline">\(P_i^{\ast}=\frac{N_i}{n}\)</span>, <span class="math inline">\(i=1,\ldots ,n\)</span>.</p>
<p>La distribución en el remuestreo de <span class="math inline">\(\mathbf{N}\)</span>, bajo el
bootstrap uniforme, es multinomial: <span class="math inline">\(\mathbf{N}\sim \mathcal{M}_n\left( n,\left( \frac{1}{n},\ldots ,\frac{1}{n} \right) \right)\)</span>. Así que su
masa de probabilidad, y por tanto la de <span class="math inline">\(\mathbf{P}^{\ast}\)</span>, es
fácilmente calculable:
<span class="math display">\[\begin{aligned}
P\left( N_1=m_1,\ldots ,N_n=m_n \right) &amp;= \frac{n!}{m_1!\cdots
m_n!}\left( \frac{1}{n} \right)^{m_1}\cdots \left( \frac{1}{n} \right)
^{m_n} \\
&amp;= \frac{n!}{m_1!\cdots m_n!n^{n}}\text{, } \\
\end{aligned}\]</span>
para <span class="math inline">\(m_1,\ldots ,m_n\)</span> enteros con <span class="math inline">\(\sum_{i=1}^{n}m_i = n\)</span>,
donde el número de átomos de probabilidad de <span class="math inline">\(\mathbf{N}\)</span> es ahora
<span class="math inline">\(\binom{n+n-1}{n}=\binom{2n-1}{n}\)</span>.</p>
<p>En general <span class="math inline">\(\binom{2n-1}{n}&lt;n^{n}\)</span>,
pues el hecho de que no importe el orden de las componentes de las
remuestras bootstrap provoca un menor número de átomos de probabilidad.
Aún así dicho cardinal es prohibitivamente grande incluso para tamaños
muestrales pequeños: para <span class="math inline">\(n=10\)</span>, resultaría abordable pues
<span class="math inline">\(\binom{19}{10}= 92\,378\)</span>, pero para <span class="math inline">\(n=20\)</span> tendríamos
<span class="math inline">\(\binom{39}{20}= 68\, 923\,264\,410\)</span>. De toda esa
enorme cantidad de átomos, el de más grande probabilidad resulta tener
una probabilidad de <span class="math inline">\(\frac{n!}{n^{n}}\)</span>, que es insignificantemente
pequeña para tamaños pequeños como <span class="math inline">\(n=20\)</span>, con
<span class="math inline">\(\frac{20!}{20^{20}}\sim 2.\, 320\,2\times 10^{-8}\)</span>. De todas
formas, existen raras ocasiones en las que el número de átomos de
probabilidad de <span class="math inline">\(R^{\ast}\)</span> resulta ser mucho menor que el de
<span class="math inline">\(\mathbf{P}^{\ast}\)</span>.</p>
<p>Para tamaños muestrales realmente pequeños es posible encontrar todos
los átomos de probabilidad de la distribución bootstrap. Un ejemplo es
la media muestral con, por ejemplo, <span class="math inline">\(n=3\)</span>.</p>

<div class="example">
<p><span id="exm:media3" class="example"><strong>Ejemplo 1.4  (Media muestral para una muestra de tamaño 3)  </strong></span><br> </p>
<p>Consideremos una muestra aleatoria simple de tamaño <span class="math inline">\(n=3\)</span> de una
población con distribución <span class="math inline">\(F\)</span> y tomemos como parámetro de interés la
media poblacional
<span class="math inline">\(\theta \left( F \right) =\mu =\int xdF\left( x \right)\)</span>.
Tomemos como estadístico de interés
<span class="math inline">\(R=R\left( \mathbf{X},F \right) =\bar{X}\)</span>.
El análogo bootstrap de esta estadístico es
<span class="math inline">\(R^{\ast}=R\left( \mathbf{X}^{\ast},F_n \right) =\bar{X}^{\ast}\)</span>,
cuya distribución en el remuestreo se puede calcular de forma exacta
debido al reducido número de átomos de probabilidad que tiene.
Esta es una distribución discreta con 10 posibles valores, cuyo
valor más probable es precisamente <span class="math inline">\(\bar{X}\)</span> que tiene una
probabilidad bootstrap de <span class="math inline">\(\frac{2}{9}\)</span>, como puede verse en la
siguiente tabla.</p>
<table style="width:100%;">
<colgroup>
<col width="21%" />
<col width="18%" />
<col width="18%" />
<col width="19%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(\mathbf{X}^{\ast}\)</span> (salvo permutaciones)</th>
<th><span class="math inline">\(\mathbf{N}\)</span> = <span class="math inline">\(\left( m_1,m_2,m_3 \right)\)</span></th>
<th><span class="math inline">\(\mathbf{P}^{\ast}\)</span> = <span class="math inline">\(\left(p_1,p_2,p_3 \right)\)</span></th>
<th><span class="math inline">\(\frac{3!}{m_1!m_2!m_3!3^{3}}\)</span></th>
<th><span class="math inline">\(\bar{X}^{\ast}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\left( X_1,X_1,X_1 \right)\)</span></td>
<td><span class="math inline">\(\left( 3,0,0 \right)\)</span></td>
<td><span class="math inline">\(\left(1,0,0 \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{27}\)</span></td>
<td><span class="math inline">\(X_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\left( X_2,X_2,X_2 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,3,0 \right)\)</span></td>
<td><span class="math inline">\(\left(0,1,0 \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{27}\)</span></td>
<td><span class="math inline">\(X_2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\left( X_3,X_3,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,0,3 \right)\)</span></td>
<td><span class="math inline">\(\left(0,0,1 \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{27}\)</span></td>
<td><span class="math inline">\(X_3\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\left( X_1,X_1,X_2 \right)\)</span></td>
<td><span class="math inline">\(\left( 2,1,0 \right)\)</span></td>
<td><span class="math inline">\(\left( \frac{2}{3},\frac{1}{3},0 \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{2X_1+X_2}{3}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\left( X_1,X_1,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 2,0,1 \right)\)</span></td>
<td><span class="math inline">\(\left( \frac{2}{3},0,\frac{1}{3} \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{2X_1+X_3}{3}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\left( X_1,X_2,X_2 \right)\)</span></td>
<td><span class="math inline">\(\left( 1,2,0 \right)\)</span></td>
<td><span class="math inline">\(\left( \frac{1}{3},\frac{2}{3},0 \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{X_1+2X_2}{3}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\left( X_2,X_2,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,2,1 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,\frac{2}{3},\frac{1}{3} \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{2X_2+X_3}{3}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\left( X_1,X_3,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 1,0,2 \right)\)</span></td>
<td><span class="math inline">\(\left( \frac{1}{3},0,\frac{2}{3} \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{X_1+2X_3}{3}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\left( X_2,X_3,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,1,2 \right)\)</span></td>
<td><span class="math inline">\(\left( 0,\frac{1}{3},\frac{2}{3} \right)\)</span></td>
<td><span class="math inline">\(\frac{1}{9}\)</span></td>
<td><span class="math inline">\(\frac{X_2+2X_3}{3}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\left( X_1,X_2,X_3 \right)\)</span></td>
<td><span class="math inline">\(\left( 1,1,1 \right)\)</span></td>
<td><span class="math inline">\(\left( \frac{1}{3},\frac{1}{3},\frac{1}{3} \right)\)</span></td>
<td><span class="math inline">\(\frac{2}{9}\)</span></td>
<td><span class="math inline">\(\frac{X_1+X_2+X_3}{3}\)</span></td>
</tr>
</tbody>
</table>
</div>
<p>En algunas ocasiones es factible encontrar expresiones cerradas
para la distribución de <span class="math inline">\(R^{\ast}\)</span>, más allá de las obvias que
consisten en enumerar el ingente número de átomos de probabilidad de
<span class="math inline">\(\mathbf{P}^{\ast}\)</span>:
<span class="math display">\[P^{\ast}\left( R^{\ast}=R\left( \left( m_1,\ldots ,m_n \right)
,F_n \right) \right)\]</span>
Veamos un ejemplo.</p>
</div>
<div id="inferencia-sobre-la-mediana" class="section level3" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Inferencia sobre la mediana</h3>
<p>En el caso de la mediana, consideremos, por simplicidad el caso de
tamaño muestral impar, <span class="math inline">\(n=2m-1\)</span>. Supongamos también que no hay empates
en los valores de la muestra (si los hubiese las expresiones serían más
farragosas pero también calculables). La versión bootstrap del
estadístico sobre el cual pivota la inferencia es <span class="math inline">\(R^{\ast}=X_{\left( m \right)}^{\ast}-X_{(m)}\)</span>. Su distribución bootstrap
podría calcularse si se obtuviese la de <span class="math inline">\(X_{(m)}^{\ast}\)</span>.
Pero ésta es factible de calcular por los pocos posibles valores que
puede tomar el estadístico <span class="math inline">\(X_{(m)}^{\ast}\)</span> (tan sólo los
valores de la muestra original) y por la sencillez del bootstrap
uniforme.
Veámoslo:
<span class="math display">\[P^{\ast}\left( X_{(m)}^{\ast}&gt;X_{(j)} \right)
=P^{\ast}\left( \#\left\{ X_i^{\ast}\leq X_{(j)}\right\}
\leq m-1 \right),\]</span>
pero
<span class="math display">\[\#\left\{ X_i^{\ast}\leq X_{(j)}\right\} \sim \mathcal{B}\left(
n,\frac{j}{n} \right),\]</span>
con lo cual
<span class="math display">\[P^{\ast}\left( X_{(m)}^{\ast}&gt;X_{(j)} \right)
=\sum_{k=0}^{m-1}\binom{n}{k}\left( \frac{j}{n} \right)^{k}
\left( \frac{n-j}{n} \right)^{n-k}\]</span>
y, por lo tanto, si <span class="math inline">\(j\geq 2\)</span>,
<span class="math display">\[\begin{aligned}
P^{\ast}\left( X_{(m)}^{\ast}=X_{(j)} \right)
=&amp;\ P^{\ast}\left( X_{(m)}^{\ast}&gt;X_{\left( j-1 \right)} \right)
-P^{\ast}\left( X_{(m)}^{\ast}&gt;X_{(j)} \right) \\
=&amp;\ \sum_{k=0}^{m-1}\binom{n}{k}\left( \frac{j-1}{n} \right)^{k}\left( \frac{
n-j+1}{n} \right)^{n-k} \\
&amp;-\sum_{k=0}^{m-1}\binom{n}{k}\left( \frac{j}{n} \right)^{k}\left( \frac{n-j}{
n} \right)^{n-k} \\
=&amp;\ \sum_{k=0}^{m-1}\binom{n}{k}\left[ \left( \frac{j-1}{n} \right)^{k}\left( 
\frac{n-j+1}{n} \right)^{n-k}-\left( \frac{j}{n} \right)^{k}\left( \frac{n-j
}{n} \right)^{n-k}\right] .
\end{aligned}\]</span></p>
<p>Cuando <span class="math inline">\(j=1\)</span>, entonces
<span class="math display">\[\begin{aligned}
P^{\ast}\left( X_{(m)}^{\ast} = X_{(1)} \right)
&amp;= 1-P^{\ast}\left( X_{(m)}^{\ast}&gt;X_{(1)} \right) \\
&amp;=  1-\sum_{k=0}^{m-1}\binom{n}{k}\left( \frac{1}{n} \right)^{k}
\left( \frac{n-1}{n} \right)^{n-k}.
\end{aligned}\]</span></p>
<!-- 
Se podría comparar la distribución exacta 
con la aproximación por Monte carlo 
-->
</div>
<div id="distribución-bootstrap-aproximada-por-monte-carlo" class="section level3" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> Distribución Bootstrap aproximada por Monte Carlo</h3>
<p>Como ya se comentó anteriormente,
al conocer el mecanismo que genera los datos en el bootstrap,
siempre se podrá simular dicho mecanismo mediante el método de Monte
Carlo. Por lo que el algoritmo general para la aproximación de Monte Carlo del
bootstrap uniforme es:</p>
<ol style="list-style-type: decimal">
<li><p>Para cada <span class="math inline">\(i=1,\ldots ,n\)</span> arrojar <span class="math inline">\(X_i^{\ast}\)</span> a partir de <span class="math inline">\(F_n\)</span></p></li>
<li><p>Obtener <span class="math inline">\(\mathbf{X}^{\ast}=\left( X_1^{\ast},\ldots ,X_n^{\ast} \right)\)</span></p></li>
<li><p>Calcular <span class="math inline">\(R^{\ast}=R\left( \mathbf{X}^{\ast},F_n \right)\)</span></p></li>
<li><p>Repetir <span class="math inline">\(B\)</span> veces los pasos 1-3 para obtener las réplicas bootstrap
<span class="math inline">\(R^{\ast (1)}\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(R^{\ast (B)}\)</span></p></li>
<li><p>Utilizar esas réplicas bootstrap para aproximar la distribución en el
muestreo de <span class="math inline">\(R\)</span></p></li>
</ol>
<p>Como se mostró en la Sección <a href="introducción.html#intro-implementacion">1.1.3</a>, el paso 1 se puede llevar a cabo simulando una distribución uniforme discreta
mediante el método de la transformación cuantil:</p>
<ol style="list-style-type: decimal">
<li>Para cada <span class="math inline">\(i=1,\ldots ,n\)</span> arrojar <span class="math inline">\(U_i\sim \mathcal{U}\left( 0,1 \right)\)</span> y
hacer <span class="math inline">\(X_i^{\ast}=X_{\left\lfloor nU_i\right\rfloor +1}\)</span></li>
</ol>
<p>Aunque en <code>R</code> se recomienda emplear la función <code>sample</code>.</p>

<div class="example">
<p><span id="exm:media-dt-desconocida" class="example"><strong>Ejemplo 1.5  (Inferencia sobre la media con varianza desconocida)  </strong></span><br> </p>
Continuando con el ejemplo de los tiempos de vida de microorganismos,
supongamos que queremos obtener una estimación por intervalo de confianza
de su vida media a partir de los 15 valores observados pero en la
situación mucho más realista de que la varianza sea desconocida.
</div>
<p>Tenemos pues
<span class="math inline">\(\mathbf{X}=\left( X_1,\ldots ,X_n \right) \sim F\,\)</span>, con
<span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> desconocidas</p>
<p>El parámetro de interés es
<span class="math display">\[\theta \left( F \right) =\mu =\int x~dF\left( x \right)\]</span>
que se estima mediante
<span class="math display">\[\theta \left( F_n \right) =\int x~dF_n\left( x \right) =\bar{X}.\]</span>
Así pues, el estadístico en el que basar la inferencia es
<span class="math display">\[R=R\left( \mathbf{X},F \right) =\sqrt{n}\frac{\bar{X}-\mu }{S_{n-1}},\]</span>
donde <span class="math inline">\(S_{n-1}^2\)</span> es la cuasivarianza muestral:
<span class="math display">\[S_{n-1}^2=\frac{1}{n-1}\sum_{j=1}^{n}\left( X_j-\bar{X} \right)^2.\]</span></p>
<p>Bajo normalidad <span class="math inline">\(\left( X\sim \mathcal{N}\left( \mu ,\sigma^2 \right) \right)\)</span>,
se sabe que <span class="math inline">\(R\sim t_{n-1}\)</span> y, en particular,
<span class="math inline">\(R\overset{d}{\rightarrow } \mathcal{N}\left( 0,1 \right)\)</span> cuando <span class="math inline">\(n\rightarrow \infty\)</span>.
Si <span class="math inline">\(F\)</span> no es normal entonces la distribución de <span class="math inline">\(R\)</span> ya no es una <span class="math inline">\(t_{n-1}\)</span>,
pero también es cierto que, bajo ciertas condiciones,
<span class="math inline">\(R\overset{d}{\rightarrow}\mathcal{N}\left(0,1 \right)\)</span>.</p>
<p>En el contexto bootstrap elegimos <span class="math inline">\(\hat{F}=F_n\,\)</span>, con lo cual se
trata de un bootstrap naïve o uniforme. El análogo bootstrap del
estadístico <span class="math inline">\(R\)</span> será
<span class="math display">\[R^{\ast}=R\left( \mathbf{X}^{\ast},F_n \right) =\sqrt{n}\frac{
\bar{X}^{\ast}-\bar{X}}{S_{n-1}^{\ast}},\]</span>
siendo
<span class="math display">\[\begin{aligned}
\bar{X}^{\ast} &amp;= \frac{1}{n}\sum_{i=1}^{n}X_i^{\ast}, \\
S_{n-1}^{\ast 2} &amp;= \frac{1}{n-1}\sum_{i=1}^{n}\left( X_i^{\ast}-
\bar{X}^{\ast} \right)^2.
\end{aligned}\]</span></p>
<p>El algoritmo bootstrap (aproximado por Monte Carlo) procedería así:</p>
<ol style="list-style-type: decimal">
<li><p>Para cada <span class="math inline">\(i=1,\ldots ,n\)</span> arrojar <span class="math inline">\(U_i\sim \mathcal{U}\left( 0,1 \right)\)</span> y
hacer <span class="math inline">\(X_i^{\ast}=X_{\left\lfloor nU_i\right\rfloor +1}\)</span></p></li>
<li><p>Obtener <span class="math inline">\(\bar{X}^{\ast}\)</span> y <span class="math inline">\(S_{n-1}^{\ast 2}\)</span></p></li>
<li><p>Calcular
<span class="math inline">\(R^{\ast}=\sqrt{n}\frac{\bar{X}^{\ast}-\bar{X}}{ S_{n-1}^{\ast}}\)</span></p></li>
<li><p>Repetir <span class="math inline">\(B\)</span> veces los pasos 1-3 para obtener las réplicas bootstrap
<span class="math inline">\(R^{\ast (1)}, \ldots, R^{\ast (B)}\)</span></p></li>
<li><p>Aproximar la distribución en el muestreo de <span class="math inline">\(R\)</span> mediante la
distribución empírica de <span class="math inline">\(R^{\ast (1)}, \ldots, R^{\ast (B)}\)</span></p></li>
</ol>
<p>El código para implementar este método es similar al del caso de varianza conocida
del Ejemplo <a href="introducción.html#exm:media-dt-conocida">1.1</a>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-1" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.143</span>, <span class="fl">0.182</span>, <span class="fl">0.256</span>, <span class="fl">0.26</span>, <span class="fl">0.27</span>, <span class="fl">0.437</span>, <span class="fl">0.509</span>, </span>
<span id="cb29-2"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-2" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.611</span>, <span class="fl">0.712</span>, <span class="fl">1.04</span>, <span class="fl">1.09</span>, <span class="fl">1.15</span>, <span class="fl">1.46</span>, <span class="fl">1.88</span>, <span class="fl">2.08</span>)</span>
<span id="cb29-3"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(muestra)</span>
<span id="cb29-4"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-4" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb29-5"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-5" aria-hidden="true" tabindex="-1"></a>x_barra <span class="ot">&lt;-</span> <span class="fu">mean</span>(muestra)</span>
<span id="cb29-6"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-6" aria-hidden="true" tabindex="-1"></a>cuasi_dt <span class="ot">&lt;-</span> <span class="fu">sd</span>(muestra)</span>
<span id="cb29-7"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Remuestreo</span></span>
<span id="cb29-9"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb29-10"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-10" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-11"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-11" aria-hidden="true" tabindex="-1"></a>remuestra <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb29-12"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-12" aria-hidden="true" tabindex="-1"></a>estadistico_boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb29-13"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb29-14"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-14" aria-hidden="true" tabindex="-1"></a>  remuestra <span class="ot">&lt;-</span> <span class="fu">sample</span>(muestra, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-15"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-15" aria-hidden="true" tabindex="-1"></a>  x_barra_boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(remuestra)</span>
<span id="cb29-16"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-16" aria-hidden="true" tabindex="-1"></a>  cuasi_dt_boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(remuestra)</span>
<span id="cb29-17"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  estadistico_boot[k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n) <span class="sc">*</span> (x_barra_boot <span class="sc">-</span> x_barra)<span class="sc">/</span>cuasi_dt_boot</span>
<span id="cb29-18"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-19"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Aproximación bootstrap de los ptos críticos</span></span>
<span id="cb29-21"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-21" aria-hidden="true" tabindex="-1"></a>pto_crit <span class="ot">&lt;-</span> <span class="fu">quantile</span>(estadistico_boot, <span class="fu">c</span>(alfa<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alfa<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb29-22"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Construcción del IC</span></span>
<span id="cb29-24"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-24" aria-hidden="true" tabindex="-1"></a>ic_inf_boot <span class="ot">&lt;-</span> x_barra <span class="sc">-</span> pto_crit[<span class="dv">2</span>] <span class="sc">*</span> cuasi_dt<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb29-25"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-25" aria-hidden="true" tabindex="-1"></a>ic_sup_boot <span class="ot">&lt;-</span> x_barra <span class="sc">-</span> pto_crit[<span class="dv">1</span>] <span class="sc">*</span> cuasi_dt<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb29-26"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-26" aria-hidden="true" tabindex="-1"></a>IC_boot <span class="ot">&lt;-</span> <span class="fu">c</span>(ic_inf_boot, ic_sup_boot)</span>
<span id="cb29-27"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(IC_boot) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">c</span>(alfa<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alfa<span class="sc">/</span><span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)</span>
<span id="cb29-28"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb29-28" aria-hidden="true" tabindex="-1"></a>IC_boot</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## 0.5030131 1.2888063</code></pre>
<p>Este procedimiento para la construcción de intervalos de confianza
se denomina <em>método percentil-t</em> y se tratará en la Sección <a href="icboot-perc-t.html#icboot-perc-t">4.3</a>.</p>
<p>Como ejemplo adicional podemos comparar la aproximación de la distribución bootstrap del estadístico con la aproximación <span class="math inline">\(t_{n-1}\)</span> basada en normalidad.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(estadistico_boot, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>))</span>
<span id="cb31-2"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> pto_crit)</span>
<span id="cb31-3"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dt</span>(x, n<span class="dv">-1</span>), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb31-4"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb31-4" aria-hidden="true" tabindex="-1"></a>pto_crit_t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alfa<span class="sc">/</span><span class="dv">2</span>, n<span class="dv">-1</span>)</span>
<span id="cb31-5"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">c</span>(<span class="sc">-</span>pto_crit_t, pto_crit_t), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="01-intro_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En este caso la distribución bootstrap del estadístico es más asimétrica, lo que se traducirá en diferencias entre las estimaciones por intervalos de confianza.
Por ejemplo, podemos obtener la estimación basada en normalidad mediante la función <code>t.test()</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cálculo-de-la-distribución-bootstrap-exacta-y-aproximada.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(muestra)<span class="sc">$</span>conf.int</span></code></pre></div>
<pre><code>## [1] 0.4599374 1.1507292
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
</div>
<div id="elección-del-número-de-réplicas-monte-carlo" class="section level3" number="1.3.5">
<h3><span class="header-section-number">1.3.5</span> Elección del número de réplicas Monte Carlo</h3>
<p>Normalmente el valor de <span class="math inline">\(B\)</span> se toma del orden de varias centenas o
incluso millares. En los casos en los que el bootstrap se utiliza para
estimar el sesgo o la varianza de un estimador, bastará tomar un número,
<span class="math inline">\(B\)</span>, de réplicas bootstrap del orden de <span class="math inline">\(B = 100, 200, 500\)</span>. Sin embargo,
cuando se trata de utilizar el bootstrap para realizar contrastes de
hipótesis o construir intervalos de confianza son necesarios valores
mayores, del tipo <span class="math inline">\(B = 500, 1000, 2000, 5000\)</span>.</p>
<!-- 
considerar distintos estadísticos: 
media, error estándar y cuantiles
-->
<p>Evidentemente, la función de distribución del estadístico de interés,
<span class="math inline">\(\psi \left( u \right) =P\left( R\leq u \right)\)</span>, se estimaría mediante
la distribución empírica de las <span class="math inline">\(B\)</span> realizaciones de la aproximación de
Monte Carlo,
<span class="math display">\[\hat{\psi}_{B}\left( u \right) =
\frac{1}{B}\sum_{i=1}^{B}\mathbf{1}\left\{ R^{\ast (i)}\leq u\right\},\]</span>
de la verdadera distribución bootstrap exacta:
<span class="math inline">\(\hat{\psi}\left(u \right) =P^{\ast}\left( R^{\ast}\leq u \right)\)</span>.
El error de MonteCarlo de <span class="math inline">\(\hat{\psi}_{B}\left( u \right)\)</span> con respecto
a <span class="math inline">\(\hat{\psi}\left( u \right)\)</span> viene dado por su varianza Monte Carlo,
pues su sesgo Monte Carlo es cero:</p>
<p><span class="math display">\[\begin{aligned}
E^{MC}\left( \hat{\psi}_{B}\left( u \right) \right) &amp;= \frac{1}{B}
\sum_{i=1}^{B}E^{MC}\left( \mathbf{1}\left\{ R^{\ast (i)}\leq
u\right\} \right) =\frac{1}{B}\sum_{i=1}^{B}P^{\ast}\left( R^{\ast \left(
i \right)}\leq u \right) \\
&amp;= \frac{1}{B}\sum_{i=1}^{B}\hat{\psi}\left( u \right) =\hat{\psi}\left(
u \right), \\
Var^{MC}\left( \hat{\psi}_{B}\left( u \right) \right) &amp;= \frac{1}{B^2}
\sum_{i=1}^{B}Var^{MC}\left( \mathbf{1}\left\{ R^{\ast (i)}\leq
u\right\} \right) \\
&amp;= \frac{1}{B^2}\sum_{i=1}^{B}P^{\ast}\left( R^{\ast (i)
}\leq u \right) \left[ 1-P^{\ast}\left( R^{\ast (i)}\leq
u \right) \right] = \\
&amp;= \frac{1}{B^2}\sum_{i=1}^{B}\hat{\psi}\left( u \right) \left( 1-\hat{\psi}
\left( u \right) \right) =\frac{1}{B}\hat{\psi}\left( u \right) \left( 1-\hat{
\psi}\left( u \right) \right) \leq \frac{1}{4B}
\end{aligned}\]</span></p>
<p>Así, el error de la aproximación de Monte Carlo al bootstrap exacto
(raíz cuadrada de la varianza del Monte Carlo), puede acotarse por
<span class="math inline">\(\frac{1}{2\sqrt{B}}\)</span>
(para más detalles sobre la convergencia de una aproximación Monte Carlo ver p.e. el <a href="https://rubenfcasal.github.io/simbook/cap4.html">Capítulo 4</a> de Fernández-Casal y Cao, 2020).</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-unif.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro-paquetes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/book_remuestreo/edit/master/01-intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["book_remuestreo.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
